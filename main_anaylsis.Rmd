---
title: "Project Analysis Group 1"
author: "Kimberly Carmona"
date: "2025-10-05"
output: html_document
---
## A. Data Management and Wrangling

These lines of code demonstrate the steps to allow the script to read the HINTS dataset. 

```{r read}
# Load "readr" package to read data
library(readr)

# Import and read HINTS data
HINTS_Data <- read_csv("/Users/chloe/Downloads/HINTSData_2020_clean.csv")
```

### Selecting relevant variables

These lines of code show the names of each variable observed in the HINTS dataset.

```{r names}
# Display names of HINTS datasset
names(HINTS_Data)
```

A data frame is then created to only select and read the appropriate variables that will be observed: Quality Care, Age, Gender at Birth, Smoking Status, Race/Ethncity, Average Number of Drinks Per Week, Minutes per week of at least moderate intensity exercise, and Body Mass Index (BMI).

```{r readvars}
# Select/read necessary variables from the dataset
HINTS_vars <- HINTS_Data[,c("QualityCare","Age","BirthGender","smokeStat","RaceEthn5", "AvgDrinksPerWeek","WeeklyMinutesModerateExercise", "BMI")]
```

## B. Descriptive Analysis
### B1. Statistical Summaries:

A data frame is created to read only the numeric (continuous) variables from the selected data: Age, Average Number of Alcoholic Drinks Per Week, Minutes per week of at least moderate intensity exercise, and Body Mass Index (BMI).

```{r selcontinuous}
#Select/read continuous variables from necessary variables being analyzed
HINTS_cont <- HINTS_Data[,c("Age","AvgDrinksPerWeek","WeeklyMinutesModerateExercise", "BMI")]

```


With these variables, a five-number summary is conducted for each variable. This includes the minimum, 1st Quartile, Median, 3rd Quartile, and maximum.


```{r fivenum}
summary(HINTS_cont)

```
The five-number summary communicates several aspects about each continuous variable.

The variable **"age"** measures the age of each participant in the study. The minimum age of the participants was 18 years old, while the maximum age was 100 years old, indicating the age of the participants ranged from 18 to 100 years old. The 1st quartile value of 43 conveys that 25 percent of participants were 43 years old or younger. The median of 58 illustrates that half of the participants were 58 years old, while the other half was older. The 3rd quartile value of 68 communicates that 75 percent of participants were 68 years old or younger. The range of ages observed in participants on a national scale suggests that the data collected aims to represent the health of adults of all ages.

The variable **"AvgDrinksPerWeek"** measures the average number of alcoholic drinks participants consumed per week. The minimum average number of alcoholic drinks per week was 0 drinks, while the maximum was 70 drinks. This means that the average number of alcoholic drinks per week ranged from 0 to 70 drinks among American adults. The maximum of 70 shows that at least one of the participants estimated they drank 70 alcoholic drinks per week on average, which is an unhealthy behavior that can have severe health consequences if such habits of consumption continue. The 1st quartile value of 0 indicates that 25 percent of participants consumed 0 alcoholic drinks per week on average, suggesting that at least a quarter of participants in the study abstained from alcohol on a weekly basis. The median value of 3.358 drinks represents how half of the participants drank an average of 3.358 alcoholic drinks or less per week. 75 percent of participants had an average number of alcoholic drinks per week of less than or equal to 4 drinks. Overall, these values communicate that a majority of American adults in the study did not consume more than 4 alcoholic drinks per week, but additional considerations in public health communication and efforts could also work to address adults who engage in unhealthy drinking habits.

The variable **"WeeklyMinutesModerateExercise"** measures the number of minutes per week that participants exercised at least moderate intensity or greater. The minimum number of minutes per week of exercise at moderate intensity or greater was 0 minutes, and the maximum was 4,620 minutes, indicating that the number of minutes per week of at least moderate-intensity exercise among American adults ranged from 0 to 4,620 minutes. The 1st quartile value of 0 indicates 25 percent of participants exercised for 0 minutes per week, meaning that a quarter of the American adults in the study do not regularly exercise at least moderate intensity. This raises concerns about the health of American adults who reported such a lack of moderate physical activity, as regular physical activity is a prominent healthy behavior that may prevent the development of chronic diseases and other health problems. The median value of 90 conveys that half of the participants in the study reported 90 minutes or less of moderate exercise per week. The 3rd quartile value of 210 means that 75 percent of participants exercised for 210 minutes or less per week at at least moderate intensity. These findings illustrate that, while a significant number of American adults report engaging in moderate exercise on a weekly basis, a greater emphasis on health communication about the importance of regular exercise could help address the lack of physical activity among a substantial portion of American adults.

The variable **"BMI"** measures participants' body mass index (BMI), which is calculated as weight in pounds divided by height in inches. The minimum BMI of among participants was 10.9 (lbs/in)^2^, while the maximum was 73.8(lbs/in)^2^, meaning the range of BMI in the study was between 10.9 and 73(lbs/in)^2^. The 1st quartile value of 24 means that 25 percent of American adults in the study had a BMI of 24(lbs/in)^2^ or less. The median value of 27.5 illustrates that half of the participants in the study had a BMI of 27.5 or less. The 3rd quartile value of 31.9 represents how 75 percent of participants had a BMI of 31.9(lbs/in)^2^ or less. As normal BMI values range from 18.9 to 24.9 (kg/m^2), these findings indicate that half of the American adults observed in this study had a BMI within the normal range.  


## B2. Descriptive Packages in R

### This part performs descriptive statistics on continuous health variables in the HINTS 2020 data set which includes age, BMI, average drinks per week, and weekly minutes of moderate exercise. The analyses are grouped by smoking status.

```{r}
# Load necessary libraries
library(dplyr)
library(skimr)

# Import dataset
data <- read.csv("data/HINTSData_2020_clean.csv")

# Group by smoking status and summarize
grouped_summary <- data %>%
  group_by(smokeStat) %>%
  summarise(
    Age_mean = mean(Age, na.rm = TRUE),
    Age_sd = sd(Age, na.rm = TRUE),
    Age_var = var(Age, na.rm = TRUE),
    
    BMI_mean = mean(BMI, na.rm = TRUE),
    BMI_sd = sd(BMI, na.rm = TRUE),
    BMI_var = var(BMI, na.rm = TRUE),
    
    AvgDrinks_mean = mean(AvgDrinksPerWeek, na.rm = TRUE),
    AvgDrinks_sd = sd(AvgDrinksPerWeek, na.rm = TRUE),
    AvgDrinks_var = var(AvgDrinksPerWeek, na.rm = TRUE),
    
    WeeklyExercise_mean = mean(WeeklyMinutesModerateExercise, na.rm = TRUE),
    WeeklyExercise_sd = sd(WeeklyMinutesModerateExercise, na.rm = TRUE),
    WeeklyExercise_var = var(WeeklyMinutesModerateExercise, na.rm = TRUE)
  )

# Display results
grouped_summary

```

**Interpretation:** The table shows differences in average age, BMI, drinking habits and exercise across smoking groups. Group 1, current smokers reported the highest average alcohol consumption at 4.87 drinks per week and the lowest exercise time at an average of 153.96 minutes per week. We can conclude that this group is most likely the group of current smokers. Group 2 consumed fewer drinks at 4.41 drinks per week and 174 minutes of exercise per week. Group 3 had the lowest alcohol consumption at 2.68 drinks per week and 157.98 minutes of exercise per week. Overall, it seems that smokers engage in fewer healthy lifestyle behaviors which in this case is more drinking and less exercise.

## II. Statistical Summary using skim() function

This part uses `skim()` to provide a detailed statistical summary for the continuous variables: Age, BMI, Average Drinks per Week and Weekly Minutes of Moderate Exercise.

```{r}
# Load the skimr package
library(skimr)

# Generate statistical summary for continuous variables
skim(data[, c("Age", "BMI", "AvgDrinksPerWeek", "WeeklyMinutesModerateExercise")])

```

**Interpretation:** The average age is 55.6 years with a standard deviation of 16.6, ranging from 18 to 100 years. This shows the data set includes a wide adult age range.The mean BMI is 28.6, which falls in the overweight category, with values ranging from 10.9 to 73.8. The mean is 3.36 drinks, and most participants report drinking 0 to 4 drinks per week, indicating generally low alcohol consumption. The mean for exercise time is 162 minutes, but the range is 0 to 4620 minutes with a high standard deviation of 271, indicating large differences in exercise levels.

These results suggest that while participants tend to be middle-aged and overweight, their exercise and alcohol habits vary significantly. There are no missing values also ensuring that the statistical summaries are accurate and complete. This information is important in understanding the health behaviors of a population, accurately depicting this sample.

## B3. Writing Functions

```{r}
# Custom function to summarize continuous variables
my_summary_func <- function(df, vars) {
  for (var in vars) {
    cat("Summary for", var, ":\n")          # Print variable name
    x <- df[[var]]                          # Extract the column

    # Five-number summary (Min, Q1, Median, Q3, Max)
    print(fivenum(x))
    
    # Mean, Standard Deviation, Variance
    cat("Mean:", mean(x, na.rm = TRUE), "\n")
    cat("Standard Deviation:", sd(x, na.rm = TRUE), "\n")
    cat("Variance:", var(x, na.rm = TRUE), "\n\n")
  }
}

# Define the continuous variables to summarize
continuous_vars <- c("Age", "BMI", "AvgDrinksPerWeek", "WeeklyMinutesModerateExercise")

# Run the custom summary function
my_summary_func(data, continuous_vars)

```

**Interpretation:**

Age: Participants range from 18 to 100 years of age with a mean of 55.6 years and a SD of 16.6, indicating that there is a wide age distribution in this sample.

BMI: The BMI ranges from 10.9 to 73.8, with a mean of 28.6, indicating that on average participants fall in the overweight category. The SD of 6.5 shows variability in body mass.

Average Drinks per Week: Weekly alcohol consumption ranges from 0 to 70 drinks, with the median being 0. A SD of 6.6 reflects that there are some higher values.

Weekly Minutes of Moderate Exercise: This sample reported a range of 0 to 4620 minutes per week of exercise, with a mean of 162 minutes. The SD of 271 shows that some participants may have been very active and other having little to no exercise time per week.

The mean and standard deviations reflect on the population's health behaviors and how much they vary. Age and BMI vary moderately, while exercise and alcohol consumption seemed to showed skewed results, some of which had extremely low or high values.

```{bash}
git status
git add 

```



## Univariate Visualization
```{r}
# setup
library(ggplot2)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Load your dataset 
HINTSData_2020_clean <- read.csv("data/HINTSData_2020_clean.csv")
```


# I. Distribution of QualityCare & RaceEthn5
# Quality Care Barplot

```{r}
# QualityCare Barplot
barplot(table(HINTSData_2020_clean$QualityCare),
        main="Distribution of Quality of Care",
        col="purple",
        xlab="Quality of Care",
        ylab="Count")

# RaceEthn5 Barplot
barplot(table(HINTSData_2020_clean$RaceEthn5),
        main="Distribution of Race/Ethnicity",
        col="lightblue",
        xlab="Race/Ethnicity",
        ylab="Count")

```

**Interpretations** 
A majority of the participants reported "very good" or "good" quality of care that was received. This can indicate posititive attitudes towards healthcare treatment and prevention.Based on this barplot, the majority of the participants identified as white.

```{r}
#II. Distribution of age and BMI variables 
# Age Histogram
hist(HINTSData_2020_clean$Age,
     main="Distribution of Age",
     xlab="Age",
     col="pink",
     breaks=20)

# BMI Histogram
hist(HINTSData_2020_clean$BMI,
     main="Distribution of BMI",
     xlab="BMI",
     col="lightgreen",
     breaks=20)
```


**Interpretations**
The first histogram show the distrubution of age ranging from around 18 years old-100 years old. The median age can be shown to be around the mid 50s. 
The second histogram displays the distribution of BMI which ranges from around 16 to just under 70. The cluster seen can be seen as the median at around the mid to early 30s. This suggests that there tends to be older and overweight participants in this study. 


 ##III. ggplot visualization analysis 
```{r}
#creating visuals using ggplot package

# QualityCare ggplot2
ggplot(HINTSData_2020_clean, aes(x=QualityCare)) +
  geom_bar(fill="purple") +
  labs(title="Distribution of Quality of Care", x="Quality of Care", y="Count")

# RaceEthn5 ggplot2
ggplot(HINTSData_2020_clean, aes(x=RaceEthn5)) +
  geom_bar(fill="lightblue") +
  labs(title="Distribution of Race/Ethnicity", x="Race/Ethnicity", y="Count") +
  theme(axis.text.x = element_text(angle=45, hjust=1))

# gge ggplot2
ggplot(HINTSData_2020_clean, aes(x=Age)) +
  geom_histogram(binwidth=5, fill="yellow", color="grey") +
  labs(title="Distribution of Age", x="Age", y="Count")

# BMI ggplot2
ggplot(HINTSData_2020_clean, aes(x=BMI)) +
  geom_histogram(binwidth=2, fill="lightgreen", color="pink") +
  labs(title="Distribution of BMI", x="BMI", y="Count")

```


##IV Creating single R function 

```{r}
# Function for categorical variables
my_visual_func_I <- function(df, var) {
  ggplot(df, aes_string(x=var)) +
    geom_bar(fill="orange") +
    labs(title=paste("Distribution of", var), x=var, y="Count")
}

# Function for continuous variables
my_visual_func_II <- function(df, var, binwidth=5) {
  ggplot(df, aes_string(x=var)) +
    geom_histogram(binwidth=binwidth, fill="darkblue", color="darkgrey") +
    labs(title=paste("Distribution of", var), x=var, y="Count")
}

# Example 
my_visual_func_I(HINTSData_2020_clean, "QualityCare")
my_visual_func_I(HINTSData_2020_clean, "RaceEthn5")
my_visual_func_II(HINTSData_2020_clean, "Age", binwidth=5)
my_visual_func_II(HINTSData_2020_clean, "BMI", binwidth=2)

```


